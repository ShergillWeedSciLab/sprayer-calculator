<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SWSL SprayCal Pro - Advanced Research Sprayer Calibration Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Professional sprayer calibration calculator for agricultural research applications">
<meta name="keywords" content="sprayer calibration, agriculture, pesticide application, GPA calculator">
<meta name="author" content="Dr. Lovreet S. Shergill, Colorado State University">

<!-- 
================================================
APP VERSION CONFIGURATION
================================================
Update these constants when releasing new versions.
These values are automatically injected into the footer
and print layouts throughout the application.
================================================
-->
<script>
  const APP_VERSION = "v2.7";
  const APP_DATE = "August 2025";
  const APP_TITLE = "SWSL SprayCal Pro";
  const DEVELOPER_NAME = "Dr. Lovreet S. Shergill";
  const INSTITUTION = "Colorado State University";
  const DEPARTMENT = "Agricultural Biology Department";
</script>

<style>
/* 
================================================
CSS CUSTOM PROPERTIES (VARIABLES)
================================================
Centralized color and sizing system for easy theming.
Modify these values to change the entire app appearance.
================================================
*/
:root {
  /* Primary color palette */
  --color-primary-green: #1E4D2B;        /* CSU brand green */
  --color-primary-orange: #D9782D;       /* CSU brand orange */
  --color-text-primary: #1c1c1e;         /* Main text color */
  --color-text-secondary: #555;          /* Secondary text color */
  --color-text-muted: #999;              /* Muted text for footer */
  
  /* Background colors */
  --color-bg-gradient: linear-gradient(135deg, #f9f9f9, #eaeaea);
  --color-card-bg: #ffffff;
  --color-input-bg: #fafafa;
  --color-results-bg: #f8f9fa;
  
  /* Interactive element colors */
  --color-button-dark: #333;
  --color-button-dark-hover: #555;
  --color-button-light: #f0f0f0;
  --color-button-light-hover: #e0e0e0;
  --color-gpa-button: #f0f0f0;
  --color-gpa-button-active: #d0d0d0;
  --color-gpa-button-hover: #e0e0e0;
  
  /* Border and outline colors */
  --color-input-border: #e0e0e0;
  --color-input-focus: rgba(217, 120, 45, 0.1);
  
  /* Spacing and sizing */
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 12px;
  --spacing-lg: 20px;
  --spacing-xl: 32px;
  
  /* Border radius values */
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 20px;
}

/* 
================================================
BASE STYLES AND LAYOUT
================================================
Global styles that apply to the entire application.
Uses modern CSS Grid and Flexbox for responsive design.
================================================
*/

/* Reset and base styles */
* {
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
  background: var(--color-bg-gradient);
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 24px;
  line-height: 1.6;
  color: var(--color-text-primary);
}

/* Main application container */
.container {
  background: var(--color-card-bg);
  width: 100%;
  max-width: 750px;
  padding: var(--spacing-xl) 28px;
  border-radius: var(--radius-xl);
  box-shadow: 0 12px 28px rgba(0,0,0,0.08);
  position: relative;
}

/* 
================================================
HEADER SECTION STYLES
================================================
Styles for the application title, subtitle, and branding
================================================
*/
.header {
  text-align: center;
  margin-bottom: 25px;
  padding-bottom: 15px;
  border-bottom: 2px solid rgba(217, 120, 45, 0.2);
}

.title {
  font-size: 2.4rem;
  font-weight: 800;
  margin: 0 0 8px;
  letter-spacing: -0.5px;
  text-shadow: 0 3px 3px rgba(0, 0, 0, 0.2);
}

.pro-badge {
  background: rgba(217, 120, 45, 0.08);
  color: var(--color-primary-orange);
  padding: 2px 6px;
  border-radius: 3px;
  font-size: 0.4em;
  font-weight: 600;
  margin-left: 4px;
  display: inline-block;
  border: none;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
  vertical-align: text-top;
  line-height: 0.9;
  white-space: nowrap;
}

.subtitle {
  font-size: 1rem;
  color: var(--color-text-secondary);
  font-weight: 500;
  margin: 0;
}

/* 
================================================
TAB NAVIGATION STYLES
================================================
Interactive tabs for switching between calculation modes.
Uses CSS transitions for smooth hover and active states.
================================================
*/
.tabs { 
  display: flex; 
  gap: var(--spacing-sm); 
  margin-bottom: 18px; 
}

.tab { 
  flex: 1; 
  text-align: center; 
  padding: 10px var(--spacing-md); 
  border: none; 
  border-radius: 10px 10px 0 0;
  font-weight: 600; 
  cursor: pointer; 
  transition: all 0.25s ease; 
  background: #f5f5f5; 
  color: var(--color-text-primary);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
  transform: translateY(0);
  font-size: 15px;
}

.tab:hover {
  background: #eee;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.tab.active {
  background: var(--color-primary-orange); 
  color: white;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(217, 120, 45, 0.3);
}

/* Tab content containers */
.tab-content { 
  display: none; 
}

.tab-content.active { 
  display: block;
  animation: tabOpen 0.4s ease-out;
}

/* Smooth tab opening animation */
@keyframes tabOpen {
  0% { 
    opacity: 0; 
    transform: translateY(10px); 
  }
  100% { 
    opacity: 1; 
    transform: translateY(0); 
  }
}

/* 
================================================
FORM INPUT STYLES
================================================
Styling for all form inputs including labels, inputs, and descriptions.
Includes focus states and accessibility considerations.
================================================
*/

/* Form labels */
label { 
  display: block; 
  font-weight: 600; 
  margin-top: 14px; 
  color: var(--color-text-primary);
  font-size: 15px;
}

/* Text inputs */
input[type="number"] { 
  width: 100%; 
  padding: var(--spacing-md); 
  margin-top: 6px; 
  border: 1px solid var(--color-input-border); 
  border-radius: 10px;
  font-size: 16px; 
  background: var(--color-input-bg); 
  outline: none; 
  transition: all 0.2s ease;
}

/* Input focus states for accessibility */
input[type="number"]:focus { 
  border-color: var(--color-primary-orange); 
  background: var(--color-card-bg); 
  box-shadow: 0 0 0 3px var(--color-input-focus);
}

/* Helper text below inputs */
.description { 
  font-size: 13px; 
  color: var(--color-text-secondary); 
  margin-top: 4px; 
  line-height: 1.35; 
}

/* 
================================================
BUTTON STYLES
================================================
Comprehensive button styling system including:
- Primary calculation buttons
- GPA preset buttons  
- Action buttons (reset, print)
All with hover states and transitions
================================================
*/

/* Primary calculation buttons */
.calc-btn { 
  width: 100%; 
  padding: 14px; 
  margin: 22px 0 12px 0;
  background: var(--color-button-dark); 
  color: white; 
  font-size: 16px; 
  font-weight: 700;
  border: none; 
  border-radius: var(--radius-md); 
  cursor: pointer; 
  transition: all 0.25s ease; 
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.calc-btn:hover {
  background: var(--color-button-dark-hover);
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.25);
}

/* GPA preset button container */
.gpa-buttons { 
  display: flex; 
  gap: 6px; 
  margin-top: 6px; 
  flex-wrap: wrap; 
}

/* Individual GPA preset buttons */
.gpa-btn { 
  flex: 1; 
  padding: 8px 10px; 
  font-size: 13px; 
  font-weight: 600; 
  border-radius: 10px; 
  border: 1px solid var(--color-input-border);
  background: var(--color-gpa-button); 
  color: var(--color-text-primary); 
  cursor: pointer; 
  transition: all 0.2s ease; 
  text-align: center;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.gpa-btn:hover {
  background: var(--color-gpa-button-hover);
}

.gpa-btn.active {
  background: var(--color-gpa-button-active); 
  border-color: #b0b0b0;
}

/* Action button container (Reset and Print) */
.actions {
  display: flex;
  gap: var(--spacing-md);
  margin-top: var(--spacing-lg);
}

/* Base action button styles */
.action-btn {
  padding: var(--spacing-md) var(--spacing-lg);
  border: none;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 700;
  transition: all 0.2s ease;
  flex: 1;
  font-size: 16px;
  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.12);
}

.action-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 6px 15px rgba(0, 0, 0, 0.18);
}

/* Reset button specific styling */
.reset-btn {
  background: var(--color-button-light);
  color: var(--color-text-primary);
}

.reset-btn:hover {
  background: var(--color-button-light-hover);
}

/* Print button specific styling */
.print-btn {
  background: var(--color-primary-green);
  color: white;
}

.print-btn:hover {
  background: #163a21;
}

/* 
================================================
RESULTS DISPLAY STYLES
================================================
Styling for the calculation results section including:
- Results container
- Grid layout for result cards
- Individual result card styling
- Hover effects and animations
================================================
*/

/* Main results container */
.results-container {
  background: var(--color-results-bg);
  border-radius: var(--radius-lg);
  padding: var(--spacing-lg);
  margin-top: var(--spacing-lg);
  border: 1px solid #e9ecef;
}

/* Results section heading */
.results-heading {
  font-size: 1.3rem !important;
  font-weight: 600 !important;
  margin: 0 0 var(--spacing-lg) !important;
  color: var(--color-primary-green) !important;
}

/* Grid layout for result cards - SCREEN DISPLAY (one line) */
.results-grid { 
  display: grid; 
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); 
  gap: var(--spacing-md); 
  margin-top: 4px; 
}

/* Individual result card styling */
.result-card { 
  background: var(--color-card-bg); 
  border-radius: 14px; 
  padding: var(--spacing-md) 14px; 
  box-shadow: 0 4px 12px rgba(0,0,0,0.12);
  display: flex; 
  flex-direction: column; 
  align-items: center;
  text-align: center;
  transition: all 0.25s ease;
}

/* Result card hover effect */
.result-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.18);
}

/* Result card title */
.result-card h3 {
  margin: 0 0 4px; 
  font-size: 16px; 
  font-weight: 700; 
  color: #333;
}

/* Result card value */
.result-card p {
  margin: 0; 
  font-size: 18px; 
  color: #333;
  font-weight: 700;
}

/* Horizontal divider in result cards */
.result-divider {
  border: none;
  height: 2px;
  background-color: rgba(0, 0, 0, 0.1);
  margin: var(--spacing-sm) 0 var(--spacing-md) 0;
  border-radius: 2px;
  width: 100%;
}

/* Orange highlight for important values */
.highlight-orange {
  color: var(--color-primary-orange);
  font-weight: 800;
}

/* 
================================================
FOOTER STYLES
================================================
Clean, professional footer with developer information
and version details. Uses flex layout for responsive design.
================================================
*/
.footer {
  margin-top: 6px;
  padding: var(--spacing-lg);
  background: rgba(248, 248, 248, 0.6);
  border-radius: var(--radius-md);
}

.footer-content {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: var(--spacing-xs);
}

.footer-info {
  font-size: 11px;
  color: var(--color-text-muted);
  font-weight: 400;
  margin: 0 0 24px 0;
}

.footer-developer {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--spacing-xs);
  margin: 0;
}

.developer-name {
  font-size: 12px;
  font-weight: 600;
  color: #888;
  margin: 0;
}

.developer-affiliation {
  font-size: 12px;
  color: #888;
  font-weight: 400;
  margin: 0;
  line-height: 1.3;
}

.footer-meta {
  display: flex;
  align-items: center;
  gap: var(--spacing-md);
  font-size: 11px;
  color: var(--color-text-muted);
  font-weight: 400;
}

/* Version badge styling */
.version-badge {
  background: linear-gradient(135deg, var(--color-primary-green), var(--color-primary-orange));
  color: white;
  padding: 3px var(--spacing-sm);
  border-radius: 10px;
  font-weight: 400;
  font-size: 11px;
  letter-spacing: 0.3px;
}

/* Print-only footer (hidden on screen) */
.print-footer {
  display: none;
}

/* 
================================================
RESPONSIVE DESIGN
================================================
Mobile-first responsive breakpoints for optimal viewing 
on all device sizes from phones to desktops.
================================================
*/

/* Mobile styles (up to 600px) */
@media (max-width: 600px) {
  .container {
    padding: var(--spacing-lg);
  }
  
  .title {
    font-size: 2rem;
  }
  
  .tabs {
    flex-direction: column;
  }
  
  .tab {
    border-radius: 10px;
    margin-bottom: 5px;
    font-size: 16px;
    padding: var(--spacing-md) 16px;
  }
  
  .results-grid {
    grid-template-columns: 1fr;
  }
  
  .actions {
    flex-direction: column;
  }
  
  .footer {
    padding: 16px;
    margin-top: var(--spacing-lg);
  }
  
  .footer-meta {
    flex-direction: column;
    gap: 6px;
  }
}

/* Tablet styles (601px to 1024px) */
@media (max-width: 1024px) and (min-width: 601px) {
  .tab {
    font-size: 15px;
    padding: var(--spacing-md) 14px;
  }
}

/* 
================================================
PRINT STYLES
================================================
Optimized print layout for field use. Hides interactive 
elements and provides clean, readable output.
================================================
*/
@media print {
  /* Reset print styles */
  body {
    background: white;
    padding: 0;
    font-size: 12pt;
    margin: 0;
  }
  
  .container {
    box-shadow: none;
    padding: 10px;
    max-width: 100%;
    margin: 0;
    border-radius: 0;
  }

  /* Hide interactive elements for print */
  .tabs, .calc-btn, .gpa-buttons, .actions, .footer {
    display: none;
  }

  /* Show only active tab content */
  .tab-content {
    display: none !important;
  }
  
  .tab-content.active {
    display: block !important;
  }
  
  .results {
    display: block !important;
  }

  /* Print header adjustments */
  .header {
    margin-bottom: 15px;
    padding-bottom: 8px;
  }
  
  .title {
    font-size: 20pt;
    margin-bottom: 5px;
  }
  
  .subtitle {
    font-size: 12pt;
  }

  /* Print results container */
  .results-container {
    background: white;
    border: 1px solid #ccc;
    border-radius: var(--radius-sm);
    padding: var(--spacing-md);
    margin-top: 10px;
    page-break-inside: avoid;
  }
  
  .results-heading {
    font-size: 14pt;
    margin: 0 0 var(--spacing-sm);
    color: var(--color-primary-green);
  }

  /* Print-optimized grid layout - Stacked in 2x2 grid */
  .results-grid {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: var(--spacing-md) !important;
    margin-top: 10px !important;
    width: 100% !important;
  }

  /* Print-optimized result cards */
  .result-card {
    box-shadow: none !important;
    border: 1px solid #ccc !important;
    border-radius: 6px !important;
    padding: 8px 6px !important;
    background: white !important;
    page-break-inside: avoid;
    font-size: 10pt;
    width: 100% !important;
    max-width: none !important;
    min-width: 0 !important;
  }
  
  .result-card h3 {
    font-size: 10pt !important;
    margin: 0 0 3px !important;
    line-height: 1.1 !important;
    color: #333 !important;
    font-weight: 600 !important;
  }
  
  .result-card p {
    font-size: 12pt !important;
    margin: 0 !important;
    line-height: 1.2 !important;
    color: #555 !important;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }
  
  .highlight-orange {
    color: var(--color-primary-orange) !important;
    font-weight: 700 !important;
  }

  /* Show print footer */
  .print-footer {
    display: block !important;
    text-align: center;
    font-size: 8pt;
    margin-top: 15px;
    padding-top: var(--spacing-sm);
    border-top: 1px solid #ddd;
    color: #666;
    page-break-inside: avoid;
  }

  /* Prevent page breaks within critical sections */
  .results-container, .result-card {
    page-break-inside: avoid;
  }
}
</style>
</head>
<body>
<!-- 
================================================
MAIN APPLICATION CONTAINER
================================================
Central container holding all application content.
Uses semantic HTML structure for accessibility.
================================================
-->
<div class="container">
  
  <!-- 
  ================================================
  HEADER SECTION
  ================================================
  Application branding, title, and description
  ================================================
  -->
  <div class="header">
    <h1 class="title">
      <span style="color: var(--color-primary-green);">SWSL</span> 
      <span style="color: var(--color-primary-orange);">SprayCal</span><span class="pro-badge">Pro</span>
    </h1>    
    <p class="subtitle">Advanced Research Sprayer Calibration Tool</p>
  </div>

  <!-- 
  ================================================
  TAB NAVIGATION
  ================================================
  Interactive tabs for switching between calculation modes:
  1. Current GPA - Analyze existing sprayer setup
  2. Target GPA - Calculate requirements for desired rate
  ================================================
  -->
  <div class="tabs">
    <button class="tab active" onclick="switchTab('current')" aria-label="Analyze current sprayer setup">
      Current GPA
    </button>
    <button class="tab" onclick="switchTab('target')" aria-label="Calculate target application rate">
      Target GPA
    </button>
  </div>

  <!-- 
  ================================================
  CURRENT GPA TAB CONTENT
  ================================================
  Form for analyzing existing sprayer configuration.
  Calculates actual GPA based on field measurements.
  
  Required inputs:
  - Nozzle spacing (boom width between nozzles)
  - Calibration distance (measured test course)
  - Time to travel distance (determines ground speed)
  - Nozzle output (flow rate measurement)
  ================================================
  -->
  <div id="current" class="tab-content active">
    
    <!-- Nozzle spacing input -->
    <label for="spacing_in">Nozzle spacing (inches)</label>
    <input type="number" id="spacing_in" value="20" min="1" step="0.5" 
           aria-describedby="spacing-desc" />
    <div id="spacing-desc" class="description">
      Center-to-center distance between adjacent nozzles in inches. 
      Enter spray width for single nozzle applications.
    </div>

    <!-- Calibration distance input -->
    <label for="calib_distance_ft">Calibration distance (feet)</label>
    <input type="number" id="calib_distance_ft" value="100" min="1" step="1" 
           aria-describedby="distance-desc" />
    <div id="distance-desc" class="description">
      Measured course length that you travel at application speed. 
      Use measuring tape and field markers for accuracy.
    </div>

    <!-- Calibration time input -->
    <label for="calib_time_sec">Calibration time for that distance (seconds)</label>
    <input type="number" id="calib_time_sec" value="10" min="1" step="0.1" 
           aria-describedby="time-desc" />
    <div id="time-desc" class="description">
      Time required to travel calibration distance at application speed. 
      Use stopwatch for precision. This defines your ground speed.
    </div>

    <!-- Nozzle flow measurement input -->
    <label for="catch_15s_ml">Nozzle flow measurement (mL/15s)</label>
    <input type="number" id="catch_15s_ml" value="150" min="0" step="0.1" 
           aria-describedby="flow-desc" />
    <div id="flow-desc" class="description">
      Volume of liquid collected from an individual nozzle over a 15-second interval. 
      <br><strong>Pro-Tip:</strong> For accurate calibration, average results from multiple nozzles (at least 3).
    </div>

    <!-- Calculate button -->
    <button class="calc-btn" onclick="calculateCurrent()" aria-label="Calculate current GPA and settings">
      Analyze Current Setup
    </button>

    <!-- 
    ================================================
    CURRENT GPA RESULTS SECTION
    ================================================
    Displays calculated results in card format:
    - Ground speed (mph)
    - Nozzle flow rate (GPM) 
    - Gallons per acre (GPA) - highlighted as primary result
    - Tank usage (tanks per acre for 50-gallon tank)
    ================================================
    -->
    <div class="results" id="results-current" style="display:none;" role="region" aria-label="Current GPA calculation results">
      <div class="results-container">
        <h2 class="results-heading">Results</h2>
        <div class="results-grid">
          
          <!-- Ground speed result -->
          <div class="result-card">
            <h3>Ground speed</h3>
            <hr class="result-divider" aria-hidden="true">
            <p><span id="speed_current" aria-label="Ground speed in miles per hour"></span> mph</p>
          </div>
          
          <!-- Nozzle flow rate result -->
          <div class="result-card">
            <h3>Nozzle flow rate</h3>
            <hr class="result-divider" aria-hidden="true">
            <p><span id="gpm_current" aria-label="Flow rate in gallons per minute"></span> GPM</p>
          </div>
          
          <!-- Primary result: Gallons per acre -->
          <div class="result-card">
            <h3>Gallons per acre</h3>
            <hr class="result-divider" aria-hidden="true">
            <p><span class="highlight-orange" id="gpa_current" aria-label="Application rate in gallons per acre"></span> GPA</p>
          </div>
          
          <!-- Tank usage calculation -->
          <div class="result-card">
            <h3>No. of 50 gal tank</h3>
            <hr class="result-divider" aria-hidden="true">
            <p><span id="tanks_per_acre_current" aria-label="Number of 50-gallon tanks needed per acre"></span> tanks/acre</p>
          </div>
          
        </div>
      </div>
      
      <!-- Action buttons for results -->
      <div class="actions">
        <button class="action-btn reset-btn" onclick="resetForm('current')" aria-label="Reset current GPA form">
          Reset Form
        </button>
        <button class="action-btn print-btn" onclick="printActiveTab()" aria-label="Print current results">
          PRINT
        </button>
      </div>
    </div>
  </div>

  <!-- 
  ================================================
  TARGET GPA TAB CONTENT
  ================================================
  Form for calculating requirements to achieve a desired GPA.
  Determines required nozzle flow rates for target application rate.
  
  Required inputs:
  - Desired GPA (with preset options for common rates)
  - Nozzle spacing 
  - Ground speed parameters (distance and time)
  ================================================
  -->
  <div id="target" class="tab-content">
    
    <!-- Target GPA selection with preset buttons -->
    <label for="target_gpa">Desired application rate (GPA)</label>
    <div class="gpa-buttons" role="group" aria-label="Preset GPA options">
      <button class="gpa-btn" onclick="setGPA(10,this)" aria-label="Set target to 10 GPA">10 GPA</button>
      <button class="gpa-btn" onclick="setGPA(15,this)" aria-label="Set target to 15 GPA">15 GPA</button>
      <button class="gpa-btn" onclick="setGPA(20,this)" aria-label="Set target to 20 GPA">20 GPA</button>
      <button class="gpa-btn active" onclick="setGPA(null,this)" aria-label="Enter custom GPA value">Custom</button>
    </div>
    <input type="number" id="target_gpa" value="15" min="0" step="1" 
           aria-describedby="target-gpa-desc" />
    <div id="target-gpa-desc" class="description">
      Click a button to select standard GPA or enter a custom value above.
    </div>

    <!-- Nozzle spacing for target calculation -->
    <label for="spacing_in_target">Nozzle spacing (inches)</label>
    <input type="number" id="spacing_in_target" value="20" min="1" step="0.5" 
           aria-describedby="spacing-target-desc" />
    <div id="spacing-target-desc" class="description">
      Center-to-center distance between adjacent nozzles in inches. 
      Enter spray width for single nozzle applications.
    </div>

    <!-- Calibration distance for target calculation -->
    <label for="calib_distance_ft_target">Calibration distance (feet)</label>
    <input type="number" id="calib_distance_ft_target" value="100" min="1" step="1" 
           aria-describedby="distance-target-desc" />
    <div id="distance-target-desc" class="description">
      Measured course length at application speed. Use measuring tape and field markers.
    </div>

    <!-- Calibration time for target calculation -->
    <label for="calib_time_sec_target">Calibration time for that distance (seconds)</label>
    <input type="number" id="calib_time_sec_target" value="10" min="1" step="0.1" 
           aria-describedby="time-target-desc" />
    <div id="time-target-desc" class="description">
      Time required to travel calibration distance. This defines your ground speed.
    </div>

    <!-- Calculate button for target -->
    <button class="calc-btn" onclick="calculateTarget()" aria-label="Calculate target GPA requirements">
      Calculate Target Requirements
    </button>

    <!-- 
    ================================================
    TARGET GPA RESULTS SECTION
    ================================================
    Displays calculated requirements to achieve target GPA:
    - Ground speed (mph) - same as current tab
    - Required nozzle flow (mL/15s and mL/min) - primary result
    - Tank usage (tanks per acre for 50-gallon tank)
    ================================================
    -->
    <div class="results" id="results-target" style="display:none;" role="region" aria-label="Target GPA calculation results">
      <div class="results-container">
        <h2 class="results-heading">Target Requirements</h2>
        <div class="results-grid">
          
          <!-- Ground speed result -->
          <div class="result-card">
            <h3>Ground speed</h3>
            <hr class="result-divider" aria-hidden="true">
            <p><span id="speed_target" aria-label="Ground speed in miles per hour"></span> mph</p>
          </div>
          
          <!-- Primary result: Required flow rate -->
          <div class="result-card">
            <h3>Required flow/nozzle</h3>
            <hr class="result-divider" aria-hidden="true">
            <p>
              <span class="highlight-orange">
                <span id="req15_ml" aria-label="Required flow in milliliters per 15 seconds"></span> mL in 15s
              </span>
              <br>
              (<span id="ml_min_target" aria-label="Required flow in milliliters per minute"></span> mL/min)
            </p>
          </div>
          
          <!-- Tank usage calculation -->
          <div class="result-card">
            <h3>No. of 50 gal tank</h3>
            <hr class="result-divider" aria-hidden="true">
            <p><span id="tanks_per_acre_target" aria-label="Number of 50-gallon tanks needed per acre"></span> tanks/acre</p>
          </div>
          
        </div>
      </div>
      
      <!-- Action buttons for results -->
      <div class="actions">
        <button class="action-btn reset-btn" onclick="resetForm('target')" aria-label="Reset target GPA form">
          Reset Form
        </button>
        <button class="action-btn print-btn" onclick="printActiveTab()" aria-label="Print target results">
          PRINT
        </button>
      </div>
    </div>
  </div>

  <!-- 
  ================================================
  FOOTER SECTION
  ================================================
  Application metadata, developer information, and version details.
  Uses dynamic content injection from version variables.
  ================================================
  -->
  <div class="footer">
    <div class="footer-content">
      
      <!-- Privacy and data notice -->
      <p class="footer-info">
        All calculations run locally in your browser. No data is stored or transmitted.
      </p>
      
      <!-- Developer information -->
      <div class="footer-developer">
        <p class="developer-name">
          Developed by <strong id="developer-name-display">Dr. Lovreet S. Shergill</strong>
        </p>
        <p class="developer-affiliation" id="institution-display">
          Agricultural Biology Department | Colorado State University
        </p>
      </div>
      
      <!-- Version and build information -->
      <div class="footer-meta">
        <span id="version-info" aria-label="Application version and build information">
          SWSL SprayCal Pro v1.2 | August 2025 | Built with AI assistance
        </span>
      </div>
      
    </div>
  </div>
  
  <!-- 
  ================================================
  PRINT-ONLY FOOTER
  ================================================
  Simplified footer that appears only in print output.
  Contains essential attribution and version information.
  ================================================
  -->
  <div class="print-footer" id="print-footer" aria-hidden="true">
    SWSL SprayCal Pro v1.2 | Developed by <strong>Dr. Lovreet S. Shergill</strong> | Colorado State University
  </div>
  
</div>

<!-- 
================================================
JAVASCRIPT APPLICATION LOGIC
================================================
All interactive functionality for the sprayer calibration tool.
Includes calculation algorithms, UI management, and utility functions.
================================================
-->
<script>
/* 
================================================
PHYSICAL CONSTANTS AND CONVERSION FACTORS
================================================
Standard agricultural and measurement conversion constants
used throughout the sprayer calibration calculations.
================================================
*/
const PHYSICAL_CONSTANTS = {
  FT_PER_MILE: 5280,           // Feet in one statute mile
  SEC_PER_HOUR: 3600,          // Seconds in one hour
  ML_PER_GALLON: 3785.41,      // Milliliters in one US gallon
  SPRAYER_CONST: 5940,         // Standard sprayer calibration constant (GPM × 5940) ÷ (MPH × nozzle spacing) = GPA
  TANK_SIZE: 50,               // Default tank size for calculations (gallons)
  CALIBRATION_TIME: 0.25       // 15 seconds as fraction of minute (15/60 = 0.25)
};

/* 
================================================
APPLICATION STATE MANAGEMENT
================================================
Global variables and state tracking for the application.
================================================
*/
let currentActiveTab = 'current';  // Track which tab is currently active
let lastCalculationResults = null; // Store last calculation for potential reuse

/* 
================================================
INITIALIZATION AND VERSION MANAGEMENT
================================================
Functions that run when the page loads to set up
dynamic content and version information.
================================================
*/

/**
 * Initialize the application when DOM is fully loaded
 * Sets up version information and any required event listeners
 */
document.addEventListener('DOMContentLoaded', function() {
  updateVersionInfo();
  initializeAccessibility();
  
  // Log application startup for debugging
  console.log(`${APP_TITLE} ${APP_VERSION} initialized successfully`);
});

/**
 * Updates version and developer information throughout the app
 * Uses the constants defined at the top of the HTML file
 */
function updateVersionInfo() {
  // Update main footer version display
  const versionElement = document.getElementById('version-info');
  if (versionElement) {
    versionElement.textContent = `${APP_TITLE} ${APP_VERSION} | ${APP_DATE} | Built with AI assistance`;
  }
  
  // Update developer name display - Fixed: Remove duplicate "Developed by" text
  const developerElement = document.getElementById('developer-name-display');
  if (developerElement) {
    developerElement.innerHTML = `<strong>${DEVELOPER_NAME}</strong>`;
  }
  
  // Update institution display
  const institutionElement = document.getElementById('institution-display');
  if (institutionElement) {
    institutionElement.textContent = `${DEPARTMENT} | ${INSTITUTION}`;
  }
  
  // Update print footer version information
  const printFooterElement = document.getElementById('print-footer');
  if (printFooterElement) {
    printFooterElement.innerHTML = `${APP_TITLE} ${APP_VERSION} | Developed by <strong>${DEVELOPER_NAME}</strong> | ${INSTITUTION}`;
  }
}

/**
 * Initialize accessibility features and ARIA attributes
 * Ensures the application is usable by assistive technologies
 */
function initializeAccessibility() {
  // Set up keyboard navigation for tabs
  const tabs = document.querySelectorAll('.tab');
  tabs.forEach((tab, index) => {
    tab.setAttribute('tabindex', index === 0 ? '0' : '-1');
    tab.setAttribute('role', 'tab');
  });
  
  // Set up ARIA attributes for tab panels
  const tabPanels = document.querySelectorAll('.tab-content');
  tabPanels.forEach((panel, index) => {
    panel.setAttribute('role', 'tabpanel');
    panel.setAttribute('aria-labelledby', index === 0 ? 'current-tab' : 'target-tab');
  });
}

/* 
================================================
USER INTERFACE MANAGEMENT
================================================
Functions that handle tab switching, form interactions,
and general UI state management.
================================================
*/

/**
 * Switches between Current GPA and Target GPA calculation modes
 * @param {string} tabId - The ID of the tab to activate ('current' or 'target')
 */
function switchTab(tabId) {
  // Validate input
  if (!['current', 'target'].includes(tabId)) {
    console.error(`Invalid tab ID: ${tabId}`);
    return;
  }
  
  // Remove active state from all tabs and content
  document.querySelectorAll('.tab').forEach(btn => {
    btn.classList.remove('active');
    btn.setAttribute('aria-selected', 'false');
    btn.setAttribute('tabindex', '-1');
  });
  
  document.querySelectorAll('.tab-content').forEach(content => {
    content.classList.remove('active');
  });
  
  // Activate selected tab
  const tabButtons = document.querySelectorAll('.tab');
  const targetIndex = tabId === 'current' ? 0 : 1;
  
  tabButtons[targetIndex].classList.add('active');
  tabButtons[targetIndex].setAttribute('aria-selected', 'true');
  tabButtons[targetIndex].setAttribute('tabindex', '0');
  tabButtons[targetIndex].focus();
  
  // Show corresponding content
  document.getElementById(tabId).classList.add('active');
  
  // Update application state
  currentActiveTab = tabId;
  
  // Log tab switch for debugging
  console.log(`Switched to ${tabId} tab`);
}

/**
 * Sets a preset GPA value and updates button states
 * @param {number|null} gpaValue - The GPA value to set, or null for custom input
 * @param {HTMLElement} clickedButton - The button that was clicked
 */
function setGPA(gpaValue, clickedButton) {
  const targetInput = document.getElementById('target_gpa');
  
  if (!targetInput) {
    console.error('Target GPA input element not found');
    return;
  }
  
  // Set the input value or focus for custom entry
  if (gpaValue !== null) {
    targetInput.value = gpaValue;
    console.log(`GPA preset set to: ${gpaValue}`);
  } else {
    // For custom input, focus and select the input field
    targetInput.focus();
    targetInput.select();
  }
  
  // Update button active states
  document.querySelectorAll('.gpa-btn').forEach(btn => {
    btn.classList.remove('active');
    btn.setAttribute('aria-pressed', 'false');
  });
  
  clickedButton.classList.add('active');
  clickedButton.setAttribute('aria-pressed', 'true');
}

/* 
================================================
FORM MANAGEMENT FUNCTIONS
================================================
Functions for resetting forms and managing input states.
================================================
*/

/**
 * Resets form inputs to default values and hides results
 * @param {string} tabType - The tab to reset ('current' or 'target')
 */
function resetForm(tabType) {
  console.log(`Resetting ${tabType} form`);
  
  if (tabType === 'current') {
    // Reset Current GPA form to defaults
    const defaultValues = {
      'spacing_in': '20',
      'calib_distance_ft': '100', 
      'calib_time_sec': '10',
      'catch_15s_ml': '150'
    };
    
    // Set default values
    Object.entries(defaultValues).forEach(([id, value]) => {
      const element = document.getElementById(id);
      if (element) element.value = value;
    });
    
    // Hide results
    const resultsElement = document.getElementById('results-current');
    if (resultsElement) resultsElement.style.display = 'none';
    
  } else if (tabType === 'target') {
    // Reset Target GPA form to defaults  
    const defaultValues = {
      'target_gpa': '15',
      'spacing_in_target': '20',
      'calib_distance_ft_target': '100',
      'calib_time_sec_target': '10'
    };
    
    // Set default values
    Object.entries(defaultValues).forEach(([id, value]) => {
      const element = document.getElementById(id);
      if (element) element.value = value;
    });
    
    // Hide results
    const resultsElement = document.getElementById('results-target');
    if (resultsElement) resultsElement.style.display = 'none';
    
    // Reset GPA button states (Custom should be active by default)
    document.querySelectorAll('.gpa-btn').forEach((btn, index) => {
      btn.classList.remove('active');
      btn.setAttribute('aria-pressed', 'false');
    });
    
    const customButton = document.querySelectorAll('.gpa-btn')[3]; // Custom button (4th button)
    if (customButton) {
      customButton.classList.add('active');
      customButton.setAttribute('aria-pressed', 'true');
    }
  }
  
  // Clear any stored calculation results
  lastCalculationResults = null;
}

/* 
================================================
INPUT VALIDATION FUNCTIONS
================================================
Functions to validate user inputs before performing calculations.
================================================
*/

/**
 * Validates an array of numeric inputs
 * @param {number[]} values - Array of values to validate
 * @returns {Object} Validation result with success flag and error message
 */
function validateInputs(values) {
  // Check if any values are not finite numbers or are negative/zero
  const invalidValues = values.filter(value => !isFinite(value) || value <= 0);
  
  if (invalidValues.length > 0) {
    return {
      isValid: false,
      errorMessage: 'Please provide valid positive numbers for all fields'
    };
  }
  
  return {
    isValid: true,
    errorMessage: null
  };
}

/**
 * Parses and validates form inputs for current GPA calculation
 * @returns {Object} Parsed values or null if validation fails
 */
function parseCurrentGPAInputs() {
  const rawValues = {
    spacingIn: document.getElementById('spacing_in').value,
    distFt: document.getElementById('calib_distance_ft').value,
    timeSec: document.getElementById('calib_time_sec').value,
    catch15mL: document.getElementById('catch_15s_ml').value
  };
  
  // Convert to numbers
  const numericValues = {
    spacingIn: parseFloat(rawValues.spacingIn),
    distFt: parseFloat(rawValues.distFt),
    timeSec: parseFloat(rawValues.timeSec),
    catch15mL: parseFloat(rawValues.catch15mL)
  };
  
  // Validate
  const validation = validateInputs(Object.values(numericValues));
  if (!validation.isValid) {
    alert(validation.errorMessage);
    return null;
  }
  
  return numericValues;
}

/**
 * Parses and validates form inputs for target GPA calculation
 * @returns {Object} Parsed values or null if validation fails
 */
function parseTargetGPAInputs() {
  const rawValues = {
    targetGPA: document.getElementById('target_gpa').value,
    spacingIn: document.getElementById('spacing_in_target').value,
    distFt: document.getElementById('calib_distance_ft_target').value,
    timeSec: document.getElementById('calib_time_sec_target').value
  };
  
  // Convert to numbers
  const numericValues = {
    targetGPA: parseFloat(rawValues.targetGPA),
    spacingIn: parseFloat(rawValues.spacingIn),
    distFt: parseFloat(rawValues.distFt),
    timeSec: parseFloat(rawValues.timeSec)
  };
  
  // Validate
  const validation = validateInputs(Object.values(numericValues));
  if (!validation.isValid) {
    alert(validation.errorMessage);
    return null;
  }
  
  return numericValues;
}

/* 
================================================
SPRAYER CALCULATION ALGORITHMS
================================================
Core mathematical functions for sprayer calibration calculations.
Based on standard agricultural engineering formulas.
================================================
*/

/**
 * Calculates ground speed from distance and time measurements
 * @param {number} distanceFeet - Distance traveled in feet
 * @param {number} timeSeconds - Time taken in seconds
 * @returns {number} Ground speed in miles per hour
 */
function calculateGroundSpeed(distanceFeet, timeSeconds) {
  // Formula: (Distance in feet / Time in seconds) × (3600 sec/hr) ÷ (5280 ft/mile) = MPH
  return (distanceFeet / timeSeconds) * (PHYSICAL_CONSTANTS.SEC_PER_HOUR / PHYSICAL_CONSTANTS.FT_PER_MILE);
}

/**
 * Calculates nozzle flow rate in gallons per minute
 * @param {number} mlPer15Seconds - Milliliters collected in 15 seconds
 * @returns {number} Flow rate in gallons per minute
 */
function calculateNozzleFlowRate(mlPer15Seconds) {
  // Convert mL/15s to gallons, then multiply by 4 to get gallons per minute
  const gallonsPer15Seconds = mlPer15Seconds / PHYSICAL_CONSTANTS.ML_PER_GALLON;
  return gallonsPer15Seconds / PHYSICAL_CONSTANTS.CALIBRATION_TIME;
}

/**
 * Calculates application rate (GPA) from flow rate, speed, and nozzle spacing
 * @param {number} gpmPerNozzle - Gallons per minute per nozzle
 * @param {number} groundSpeedMph - Ground speed in miles per hour
 * @param {number} nozzleSpacingInches - Nozzle spacing in inches
 * @returns {number} Application rate in gallons per acre
 */
function calculateGPA(gpmPerNozzle, groundSpeedMph, nozzleSpacingInches) {
  // Standard sprayer formula: (GPM × 5940) ÷ (MPH × nozzle spacing in inches) = GPA
  return (gpmPerNozzle * PHYSICAL_CONSTANTS.SPRAYER_CONST) / (groundSpeedMph * nozzleSpacingInches);
}

/**
 * Calculates required nozzle flow rate for a target GPA
 * @param {number} targetGPA - Desired application rate in gallons per acre
 * @param {number} groundSpeedMph - Ground speed in miles per hour  
 * @param {number} nozzleSpacingInches - Nozzle spacing in inches
 * @returns {number} Required flow rate in gallons per minute
 */
function calculateRequiredFlowRate(targetGPA, groundSpeedMph, nozzleSpacingInches) {
  // Rearranged sprayer formula: (GPA × MPH × nozzle spacing) ÷ 5940 = GPM needed
  return (targetGPA * groundSpeedMph * nozzleSpacingInches) / PHYSICAL_CONSTANTS.SPRAYER_CONST;
}

/**
 * Calculates tank usage (tanks per acre)
 * @param {number} gpa - Application rate in gallons per acre
 * @param {number} tankSize - Tank capacity in gallons
 * @returns {string} Tanks per acre formatted to 2 decimal places
 */
function calculateTankUsage(gpa, tankSize = PHYSICAL_CONSTANTS.TANK_SIZE) {
  return gpa > 0 ? (tankSize / gpa).toFixed(2) : '0.00';
}

/* 
================================================
MAIN CALCULATION FUNCTIONS
================================================
Primary calculation functions called by user interface buttons.
These orchestrate input parsing, calculations, and result display.
================================================
*/

/**
 * Performs current GPA analysis calculation
 * Analyzes existing sprayer setup to determine actual application rate
 */
function calculateCurrent() {
  console.log('Starting current GPA calculation');
  
  // Parse and validate inputs
  const inputs = parseCurrentGPAInputs();
  if (!inputs) return; // Validation failed
  
  try {
    // Perform calculations
    const groundSpeed = calculateGroundSpeed(inputs.distFt, inputs.timeSec);
    const nozzleFlowRate = calculateNozzleFlowRate(inputs.catch15mL);
    const applicationRate = calculateGPA(nozzleFlowRate, groundSpeed, inputs.spacingIn);
    const tankUsage = calculateTankUsage(applicationRate);
    
    // Store results for potential debugging/reuse
    lastCalculationResults = {
      type: 'current',
      inputs,
      results: { groundSpeed, nozzleFlowRate, applicationRate, tankUsage }
    };
    
    // Display results in UI
    displayCurrentResults({
      groundSpeed: groundSpeed.toFixed(2),
      nozzleFlowRate: nozzleFlowRate.toFixed(3), 
      applicationRate: applicationRate.toFixed(2),
      tankUsage: tankUsage
    });
    
    console.log('Current GPA calculation completed successfully');
    
  } catch (error) {
    console.error('Error in current GPA calculation:', error);
    alert('An error occurred during calculation. Please check your inputs and try again.');
  }
}

/**
 * Performs target GPA requirements calculation  
 * Calculates flow rate requirements to achieve desired application rate
 */
function calculateTarget() {
  console.log('Starting target GPA calculation');
  
  // Parse and validate inputs
  const inputs = parseTargetGPAInputs();
  if (!inputs) return; // Validation failed
  
  try {
    // Perform calculations
    const groundSpeed = calculateGroundSpeed(inputs.distFt, inputs.timeSec);
    const requiredFlowRateGPM = calculateRequiredFlowRate(inputs.targetGPA, groundSpeed, inputs.spacingIn);
    
    // Convert GPM to mL/min and mL/15s for practical measurement
    const requiredFlowRateMLPerMin = requiredFlowRateGPM * PHYSICAL_CONSTANTS.ML_PER_GALLON;
    const requiredFlowRateMLPer15s = requiredFlowRateMLPerMin * PHYSICAL_CONSTANTS.CALIBRATION_TIME;
    
    const tankUsage = calculateTankUsage(inputs.targetGPA);
    
    // Store results for potential debugging/reuse
    lastCalculationResults = {
      type: 'target',
      inputs,
      results: { 
        groundSpeed, 
        requiredFlowRateGPM, 
        requiredFlowRateMLPerMin, 
        requiredFlowRateMLPer15s, 
        tankUsage 
      }
    };
    
    // Display results in UI
    displayTargetResults({
      groundSpeed: groundSpeed.toFixed(2),
      requiredMLPer15s: requiredFlowRateMLPer15s.toFixed(1),
      requiredMLPerMin: requiredFlowRateMLPerMin.toFixed(1),
      tankUsage: tankUsage
    });
    
    console.log('Target GPA calculation completed successfully');
    
  } catch (error) {
    console.error('Error in target GPA calculation:', error);
    alert('An error occurred during calculation. Please check your inputs and try again.');
  }
}

/* 
================================================
RESULT DISPLAY FUNCTIONS
================================================
Functions that update the UI with calculation results.
================================================
*/

/**
 * Displays current GPA calculation results in the UI
 * @param {Object} results - Formatted results to display
 */
function displayCurrentResults(results) {
  // Show results container
  const resultsContainer = document.getElementById('results-current');
  if (resultsContainer) {
    resultsContainer.style.display = 'block';
    
    // Smooth scroll to results
    resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }
  
  // Update individual result displays
  const resultMappings = {
    'speed_current': results.groundSpeed,
    'gpm_current': results.nozzleFlowRate,
    'gpa_current': results.applicationRate,
    'tanks_per_acre_current': results.tankUsage
  };
  
  Object.entries(resultMappings).forEach(([elementId, value]) => {
    const element = document.getElementById(elementId);
    if (element) {
      element.textContent = value;
    } else {
      console.warn(`Result display element not found: ${elementId}`);
    }
  });
}

/**
 * Displays target GPA calculation results in the UI
 * @param {Object} results - Formatted results to display
 */
function displayTargetResults(results) {
  // Show results container
  const resultsContainer = document.getElementById('results-target');
  if (resultsContainer) {
    resultsContainer.style.display = 'block';
    
    // Smooth scroll to results
    resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }
  
  // Update individual result displays
  const resultMappings = {
    'speed_target': results.groundSpeed,
    'req15_ml': results.requiredMLPer15s,
    'ml_min_target': results.requiredMLPerMin,
    'tanks_per_acre_target': results.tankUsage
  };
  
  Object.entries(resultMappings).forEach(([elementId, value]) => {
    const element = document.getElementById(elementId);
    if (element) {
      element.textContent = value;
    } else {
      console.warn(`Result display element not found: ${elementId}`);
    }
  });
}

/* 
================================================
UTILITY FUNCTIONS
================================================
General utility functions for print functionality and other features.
================================================
*/

/**
 * Triggers the browser's print dialog
 * Optimized for clean field-ready printouts
 */
function printActiveTab() {
  console.log(`Printing ${currentActiveTab} tab results`);
  
  // Add print-specific class to body if needed for additional print styling
  document.body.classList.add('printing');
  
  // Trigger print dialog
  window.print();
  
  // Remove print class after printing
  setTimeout(() => {
    document.body.classList.remove('printing');
  }, 1000);
}

/**
 * Exports calculation data (future enhancement placeholder)
 * Could be extended to export CSV, PDF, or other formats
 */
function exportResults() {
  if (!lastCalculationResults) {
    alert('No calculation results to export. Please perform a calculation first.');
    return;
  }
  
  // Future enhancement: implement data export functionality
  console.log('Export functionality - future enhancement', lastCalculationResults);
}

/* 
================================================
ERROR HANDLING AND DEBUGGING
================================================
Global error handling and debugging utilities.
================================================
*/

/**
 * Global error handler for unhandled errors
 */
window.addEventListener('error', function(event) {
  console.error('Global error caught:', event.error);
  
  // User-friendly error message
  if (event.error.message.includes('calculation')) {
    alert('A calculation error occurred. Please verify your inputs and try again.');
  }
});

/**
 * Console logging for debugging (only in development)
 * Remove or disable in production builds
 */
function debugLog(message, data = null) {
  if (APP_VERSION.includes('dev') || window.location.hostname === 'localhost') {
    console.log(`[DEBUG] ${message}`, data || '');
  }
}

/* 
================================================
APPLICATION READY
================================================
Final initialization and ready state logging.
================================================
*/
console.log(`${APP_TITLE} ${APP_VERSION} - JavaScript loaded successfully`);
console.log('Available functions: calculateCurrent, calculateTarget, switchTab, setGPA, resetForm, printActiveTab');
</script>

</body>
</html>
