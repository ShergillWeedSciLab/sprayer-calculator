<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SWSL SprayCal Pro</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
:root {
  --bg1: #fefefe;
  --bg2: #f2f5f8;
  --card: #ffffff;
  --text: #1c1c1e;
  --accent: #4caf50;
  --accent-dark: #357a38;
  --border: #ddd;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
  background: linear-gradient(135deg, var(--bg1), var(--bg2));
  color: var(--text);
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  padding: 24px;
  box-sizing: border-box;
}

.container {
  background: var(--card);
  width: 100%;
  max-width: 680px;
  padding: 32px 28px;
  border-radius: 20px;
  box-shadow: 0 12px 28px rgba(0,0,0,0.08);
}

h1 {
  font-size: 2rem;
  font-weight: 800;
  text-align: center;
  margin: 0 0 24px;
  color: var(--text);
}

.tabs {
  display: flex;
  gap: 8px;
  border-bottom: 2px solid var(--border);
  margin-bottom: 18px;
}

.tab {
  flex: 1;
  text-align: center;
  padding: 10px 12px;
  border: none;
  background: #f0f2f5;
  color: #333;
  border-radius: 10px 10px 0 0;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.25s ease;
}
.tab.active { background: var(--accent); color: white; }

label { display:block; font-weight:600; margin-top:14px; color:#444; }
input { width:100%; padding:12px; margin-top:6px; border:1px solid var(--border); border-radius:10px; font-size:16px; background:#fafafa; outline:none; transition:border 0.2s ease,background 0.2s ease; box-sizing:border-box;}
input:focus{ border-color: var(--accent); background:#fff;}

.description { font-size:13px; color:#666; margin-top:4px; line-height:1.35; }

.calc-btn {
  width:100%;
  padding:14px;
  margin-top:22px;
  background:#2e7d32;
  color:white;
  font-size:16px;
  font-weight:700;
  border:none;
  border-radius:12px;
  cursor:pointer;
  transition: background 0.25s ease;
}
.calc-btn:hover{ background:#1b4d20; }

.gpa-buttons {
  display:flex;
  gap:6px;
  margin-top:6px;
}
.gpa-buttons button{
  flex:1;
  padding:6px 0;
  border-radius:8px;
  border:none;
  cursor:pointer;
  font-weight:600;
  background:#c8e6c9;
  color:#1b5e20;
  transition: background 0.2s ease;
}
.gpa-buttons button.selected { background:#2e7d32; color:white; }

.result-card {
  background: #e8f5e9;
  border-radius:12px;
  padding:12px 16px;
  margin-bottom:10px;
  box-shadow:0 2px 6px rgba(0,0,0,0.08);
  font-size:14px;
}

.results h2{margin:0 0 10px;font-size:1.25rem;color:#357a38;}
.footer {text-align:center;font-size:12.5px;color:#666;margin-top:18px;}
.tab-content{display:none;}
.tab-content.active{display:block;}
</style>
</head>
<body>
<div class="container">
<h1>SWSL SprayCal Pro</h1>

<div class="tabs">
  <button class="tab active" onclick="switchTab('current')">Current GPA</button>
  <button class="tab" onclick="switchTab('target')">Target GPA</button>
</div>

<!-- CURRENT GPA -->
<div id="current" class="tab-content active">
  <label>Number of nozzles</label>
  <input type="number" id="n_nozzles" value="4" min="1"/>
  <div class="description">Total nozzles on the boom. GPA is independent of nozzle count.</div>

  <label>Nozzle spacing (inches)</label>
  <input type="number" id="spacing_in" value="20" min="1" step="0.5"/>
  <div class="description">Center-to-center distance between adjacent nozzles in inches.</div>

  <label>Calibration distance (feet)</label>
  <input type="number" id="calib_distance_ft" value="100" min="1" step="1"/>
  <div class="description">Measured course length traveled at operating speed.</div>

  <label>Calibration time (seconds)</label>
  <input type="number" id="calib_time_sec" value="15" min="1" step="0.1"/>
  <div class="description">Time to travel the calibration distance at operating speed.</div>

  <label>Per nozzle catch in 15 seconds (mL)</label>
  <input type="number" id="catch_15s_ml" value="150" min="0" step="0.1"/>
  <div class="description">Collect output from one nozzle for 15 seconds. <strong>Pro tip:</strong> average from 3 nozzles.</div>

  <button class="calc-btn" onclick="calculateCurrent()">Calculate Current GPA</button>

  <div class="results" id="results-current" style="display:none;">
    <h2>Results</h2>
    <div class="result-card"><p><b>Ground speed:</b> <span id="speed_current"></span> mph</p></div>
    <div class="result-card"><p><b>Nozzle flow rate:</b> <span id="gpm_current"></span> fl oz/min</p></div>
    <div class="result-card"><p><b>Per nozzle in 15 s:</b> <span id="pernoz15_fl"></span> fl oz (<span id="pernoz15_ml"></span> mL)</p></div>
    <div class="result-card"><p><b>Gallons per acre (GPA):</b> <span id="gpa_current"></span></p></div>
  </div>
</div>

<!-- TARGET GPA -->
<div id="target" class="tab-content">
  <label>Desired application rate (GPA)</label>
  <div class="gpa-buttons">
    <button onclick="setGPA(10)">10</button>
    <button onclick="setGPA(15)">15</button>
    <button onclick="setGPA(20)">20</button>
    <button onclick="setGPA('custom')">Custom</button>
  </div>
  <input type="number" id="target_gpa" value="15" min="0" step="0.1" style="margin-top:6px;"/>

  <label>Nozzle spacing (inches)</label>
  <input type="number" id="spacing_in_target" value="20" min="1" step="0.5"/>
  <div class="description">Distance between nozzles center-to-center in inches.</div>

  <label>Calibration distance (feet)</label>
  <input type="number" id="calib_distance_ft_target" value="100" min="1" step="1"/>
  <div class="description">Measured course length traveled at operating speed.</div>

  <label>Calibration time (seconds)</label>
  <input type="number" id="calib_time_sec_target" value="15" min="1" step="0.1"/>
  <div class="description">Time to travel the calibration distance at operating speed.</div>

  <button class="calc-btn" onclick="calculateTarget()">Calculate Required Per Nozzle</button>

  <div class="results" id="results-target" style="display:none;">
    <h2>Results</h2>
    <div class="result-card"><p><b>Ground speed:</b> <span id="speed_target"></span> mph</p></div>
    <div class="result-card"><p><b>Required nozzle flow:</b> <span id="gpm_target"></span> fl oz/min</p></div>
    <div class="result-card"><p><b>Required per nozzle in 15 s:</b> <span id="req15_fl"></span> fl oz (<span id="req15_ml"></span> mL)</p></div>
  </div>
</div>

<div class="footer">
  All calculations run locally in your browser. No data is stored.
</div>
<div class="footer">
  Created by: Dr. Lovreet S. Shergill
</div>
</div>

<script>
const FT_PER_MILE=5280, SEC_PER_HOUR=3600, ML_PER_GALLON=3785.41, ML_TO_GALLON=0.000264172, SPRAYER_CONST=5940, FL_OZ_PER_GAL=128;

function switchTab(id){
  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  document.querySelectorAll(".tab-content").forEach(c=>c.classList.remove("active"));
  if(id==='current'){ document.querySelectorAll(".tab")[0].classList.add("active"); document.getElementById("current").classList.add("active");}
  else{ document.querySelectorAll(".tab")[1].classList.add("active"); document.getElementById("target").classList.add("active");}
}

// GPA button handling
function setGPA(val){
  document.querySelectorAll(".gpa-buttons button").forEach(b=>b.classList.remove("selected"));
  if(val==='custom'){document.getElementById("target_gpa").value='';}
  else{document.getElementById("target_gpa").value=val;}
  event.currentTarget.classList.add("selected");
}

function calculateCurrent(){
  const nNoz=parseFloat(document.getElementById("n_nozzles").value),
        spacingIn=parseFloat(document.getElementById("spacing_in").value),
        distFt=parseFloat(document.getElementById("calib_distance_ft").value),
        timeSec=parseFloat(document.getElementById("calib_time_sec").value),
        catch15mL=parseFloat(document.getElementById("catch_15s_ml").value);
  if(!isFinite(nNoz)||!isFinite(spacingIn)||!isFinite(distFt)||!isFinite(timeSec)||!isFinite(catch15mL)||nNoz<=0||spacingIn<=0||distFt<=0||timeSec<=0||catch15mL<0){alert("Enter valid positive values."); return;}
  const mph=(distFt/timeSec)*(SEC_PER_HOUR/FT_PER_MILE);
  const catch15_gal=catch15mL*ML_TO_GALLON;
  const gpm_per_nozzle=catch15_gal/0.25;
  const gpm_fl_oz=gpm_per_nozzle*FL_OZ_PER_GAL;
  const pernoz15_fl=catch15_gal*FL_OZ_PER_GAL;
  const gpa=(gpm_per_nozzle*SPRAYER_CONST)/(mph*spacingIn);
  document.getElementById("results-current").style.display="block";
  document.getElementById("speed_current").innerText=mph.toFixed(2);
  document.getElementById("gpm_current").innerText=gpm_fl_oz.toFixed(2);
  document.getElementById("pernoz15_fl").innerText=pernoz15_fl.toFixed(2);
  document.getElementById("pernoz15_ml").innerText=catch15mL.toFixed(1);
  document.getElementById("gpa_current").innerText=gpa.toFixed(2);
}

function calculateTarget(){
  const targetGPA=parseFloat(document.getElementById("target_gpa").value),
        spacingIn=parseFloat(document.getElementById("spacing_in_target").value),
        distFt=parseFloat(document.getElementById("calib_distance_ft_target").value),
        timeSec=parseFloat(document.getElementById("calib_time_sec_target").value);
  if(!isFinite(targetGPA)||!isFinite(spacingIn)||!isFinite(distFt)||!isFinite(timeSec)||targetGPA<0||spacingIn<=0||distFt<=0||timeSec<=0){alert("Enter valid positive values."); return;}
  const mph=(distFt/timeSec)*(SEC_PER_HOUR/FT_PER_MILE);
  const gpm_needed=(targetGPA*mph*spacingIn)/SPRAYER_CONST;
  const req15_gal=gpm_needed*0.25;
  const req15_ml=req15_gal*ML_PER_GALLON;
  const req15_fl=req15_gal*FL_OZ_PER_GAL;
  const gpm_fl_oz=gpm_needed*FL_OZ_PER_GAL;
  document.getElementById("results-target").style.display="block";
  document.getElementById("speed_target").innerText=mph.toFixed(2);
  document.getElementById("gpm_target").innerText=gpm_fl_oz.toFixed(2);
  document.getElementById("req15_fl").innerText=req15_fl.toFixed(2);
  document.getElementById("req15_ml").innerText=req15_ml.toFixed(1);
}
</script>
</body>
</html>
